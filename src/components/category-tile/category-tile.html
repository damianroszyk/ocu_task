<div
    class="category-tile"
    ui-sref="category($ctrl.category.stateParams)"
    ng-class="{
        'category-tile--featured': $ctrl.category.featured,
		'category-tile--expanded': $ctrl.category.expanded,
		'category-tile--right': $parent.$index < 6 || ($parent.$index - 2) % 4 !== 0,
		'category-tile--left': $parent.$index >= 6 && ($parent.$index - 2) % 4 === 0
    }">
	<div class="category-tile__image">
		<img
			ng-src="{{::$ctrl.category.coverImage}}"
			fallback-image="$ctrl.fallbackImage"/>
	</div>
    <div class="category-tile-meta">
		<img
			class="category-tile__icon"
			fallback-image
			ng-src="{{::$ctrl.category.iconImage}}" />
		<h4 class="category-tile__title text--xl text--normal">
	        {{::$ctrl.category.name}}
		</h4>
    </div>
    <button
        class="category-tile__control category-tile__control--plus-white"
        ng-if="::$ctrl.category.hasPlaylists"
        ng-click="$ctrl.toggleCategoryExpand(false, $event)">
    </button>
    <div
        class="category-tile__subcategories animated"
		click-outside="$ctrl.toggleCategoryExpand(true)"
        ng-show="$ctrl.category.expanded">
		<button
	        class="category-tile__control category-tile__control--close-black"
	        ng-click="$ctrl.toggleCategoryExpand(true, $event)">
	    </button>
		<h5 class="subcategories-tile__title">
			<strong>
				Top {{$ctrl.category.playlists.length}}
			</strong>
			{{::$ctrl.category.name}} playlists
		</h5>
		<div
			class="subcategories-loader"
			ng-hide="$ctrl.playlistsAreLoaded">
			<div class="subcategories-loader__element"></div>
		</div>
        <ul class="subcategories-list">
            <li
				class="subcategories-list-element"
				ng-repeat="playlist in ::$ctrl.category.playlists"
				ng-click="$event.stopPropagation()"
				ui-sref="playlist({slug: playlist.slug})">
				<p class="subcategories-list-element__title">
					{{::$index + 1}}. {{::playlist.name}}
				</p>
				<span
					class="subcategories-list-element__description"
					ng-bind-html="$ctrl.playlistDescription(playlist.description)">
				</span>
            </li>
        </ul>
		<button
			ng-show="$ctrl.playlistsAreLoaded"
			class="btn-circled subcategories__control"
			ui-sref="category($ctrl.category.stateParams)"
			translate="{{::'SEE_ALL_PLAYLISTS_BUTTON'}}"
			translate-values='{ categoryName: $ctrl.category.name}'>
		</button>
    </div>
</div>
